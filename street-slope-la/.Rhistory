<<<<<<< HEAD
=======
<<<<<<< HEAD
runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
shiny::runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
shiny::runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
shiny::runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
shiny::runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
shiny::runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
shiny::runApp('GitHub/acs-commute-shiny/acs_commute')
install.packages('acs')
install.packages('tigris')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/acs-commute-shiny/acs_commute')
la_tract_modesplit <- acs.fetch(endyear = 2015, geography = la_tracts, table.number = "B08301", col.names = "pretty")
##### Setup
library(acs) # For downloading ACS Data
library(tigris) # For census boundary data
library(leaflet) # For interactive mapping
api.key.install(key="00a2d85a7c7b1346879d0e355cc0361f30188f28") # ACS Data API Key
##### Download / Prep Data
# Tigris: ACS Boundaries
options(tigris_class = "sf")
tracts <- tracts(state = 'CA', county = "Los Angeles", cb=TRUE) # If cb is set to TRUE, download a generalized (1:500k) tracts file. Defaults to FALSE (the most detailed TIGER/Line file)
# ACS: Means of Transportation for all census tracts in the Los Angeles County
years <- c(2010,2011,2012,2013,2014,2015)
la_tracts <- geo.make(state = "CA", county = "Los Angeles", tract = "*")
la_tract_modesplit <- acs.fetch(endyear = 2015, geography = la_tracts, table.number = "B08301", col.names = "pretty")
la_tract_modesplit <- lapply(years, function(x) {
acs.fetch(endyear = x,
geography = la_tracts,
table.number = "B08301",
col.names = "pretty")
})
shiny::runApp('GitHub/acs-commute-shiny/acs_commute')
runApp('GitHub/vzcd-shiny/app/VZ_Viewer')
install.packages('tidyverse')
setwd("~/GitHub/la-street-slope")
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("Data/Street_Pavement_Condition.shp"))
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("Data/Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("Data/Street_Pavement_Condition", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("Data/Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("Data/Street_Pavement_Condition", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("Data/Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("C:/Users/dotcid034/Documents/GitHub/la-street-slope/Data/Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("C:\Users\dotcid034\Documents\GitHub\la-street-slope\Data\Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("C:\\Users\dotcid034\Documents\GitHub\la-street-slope\Data\Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("C:\\Users\\dotcid034\Documents\GitHub\la-street-slope\Data\Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read(system.file("C:\\Users\\dotcid034\\Documents\\GitHub\\la-street-slope\\Data\\Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
fname <- system.file("Data/Street_Pavement_Condition.shp", package="sf")
bss <- st_read(system.file("C:\\Users\\dotcid034\\Documents\\GitHub\\la-street-slope\\Data\\Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
=======
>>>>>>> origin/master
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
fname <- system.file("Data/Street_Pavement_Condition.shp", package="sf")
print(fname)
bss <- st_read(system.file("C:\\Users\\dotcid034\\Documents\\GitHub\\la-street-slope\\Data\\Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
fname <- system.file("~Data/Street_Pavement_Condition.shp", package="sf")
print(fname)
bss <- st_read(system.file("C:\\Users\\dotcid034\\Documents\\GitHub\\la-street-slope\\Data\\Street_Pavement_Condition.shp", package="sf"), quiet=TRUE)
dir()
file.exists("Data")
file.exists("Data/Street_Pavement_Condition.shp")
fname <- system.file("Data/Street_Pavement_Condition.shp")
fname
fname <- system.file("Data/Street_Pavement_Condition.shp",package="sf")
fname
fname <- "Data/Street_Pavement_Condition.shp"
fname
st_read(fname)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("Data/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
# import elevation data
head(bss)
head(boe)
attributes(boe)
attributes(boe)
glimpse(boe)
glimpse(boe)
glimpse(bss)
glimpse(bss)
glimpse(boe)
glimpse(bss)
# trim bss centerline
bss <- bss %>%
select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
rename(sect.id = SECT_ID,
street = PRIME,
from = FROM_,
to = TO_,
surface = SURF1,
length.ft <- ZLENGTH,
width.ft <- ZWIDTH,
geom <- geometry)
# trim bss centerline
bss <- bss %>%
select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft <- 'ZLENGTH',
width.ft <- 'ZWIDTH',
geom <- 'geometry')
# trim bss centerline
bss <- bss %>%
select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
geom = 'geometry')
# trim boe centerline
boe <- boe %>%
select(ASSETID, INT_ID_FRO, INT_ID_TO, SECT_ID, OLD_STREET, Street_Des) %>%
rename(asset.id = 'ASSETID',
fromint.id = 'INT_ID_FRO',
toint.id = 'INT_ID_TO',
sect.id = 'SECT_ID',
old.desig = 'OLD_STREET',
new.desig = 'Street_Des')
# left-join bss <- boe
streets <- bss %>%
left_join(boe, by="sect.id")
# load libraries
library(sf)
library(tidyverse)
<<<<<<< HEAD
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/dotcid034/Documents/NonGitHubData/boe/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
# import elevation data
la_n <- st_read()
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/dotcid034/Documents/NonGitHubData/boe/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
# import elevation data
#la_n <- st_read()
#la_s <- st_read()
glimpse(boe)
glimpse(bss)
=======
install.packages('tidyverse')
install.packages('tidyverse')
# load libraries
library(sf)
library(tidyverse)
require(devtools)
install.packages('devtools')
require(devtools)
install.packages('devtools')
require(devtools)
install_version('tidyverse', version '1.1.1', repos='http://cran.us.r-project.org')
install_version(“tidyverse”, version = “1.1.1”, repos = “http://cran.us.r-project.org”)
install_version(tidyverse, version = “1.1.1”, repos = “http://cran.us.r-project.org”)
install_version(tidyverse, version = 1.1.1, repos = “http://cran.us.r-project.org”)
install_version(tidyverse, version = 1.1.1, repos = http://cran.us.r-project.org)
install_version('tidyverse', version = '1.1.1', repos = “http://cran.us.r-project.org”)
install_version('tidyverse', version = '1.1.1', repos = 'http://cran.us.r-project.org')
# load libraries
library(sf)
#library(tidyverse)
library(leaflet)
# import street data
>>>>>>> ab384e6cd3f017dce9e7d273fac41bf48f398611
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/Tim/Documents/data/street-slope-la/Streets_Centerline/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
>>>>>>> origin/master
# trim bss centerline
bss <- bss %>%
select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
<<<<<<< HEAD
geom = 'geometry')
# trim boe centerline
boe <- boe %>%
select(ASSETID, INT_ID_FRO, INT_ID_TO, SECT_ID, OLD_STREET, Street_Des) %>%
rename(asset.id = 'ASSETID',
fromint.id = 'INT_ID_FRO',
toint.id = 'INT_ID_TO',
sect.id = 'SECT_ID',
old.desig = 'OLD_STREET',
new.desig = 'Street_Des') %>%
st_set_geometry(NULL)
# left-join bss <- boe
streets <- bss %>%
left_join(boe, by="sect.id")
# trim bss centerline
bss <- bss %>%
select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
=======
geom = 'geometry') %>%
mutate(sect.id = as.double(sect.id))
# trim bss centerline
bss <- bss %>%
dplyr::select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
>>>>>>> origin/master
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
<<<<<<< HEAD
geom = 'geometry')
glimpse(boe)
glimpse(bss)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/dotcid034/Documents/NonGitHubData/boe/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
# import elevation data
#la_n <- st_read()
#la_s <- st_read()
# trim bss centerline
bss <- bss %>%
select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
=======
geom = 'geometry') %>%
mutate(sect.id = as.double(sect.id))
library(dplyr)
install.packages('dplyr')
install.packages('dplyr')
install.packages("dplyr")
library(dplyr)
# trim bss centerline
bss <- bss %>%
dplyr::select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
geom = 'geometry') %>%
mutate(sect.id = as.double(sect.id))
# trim boe centerline
boe <- boe %>%
dplyr::select(ASSETID, INT_ID_FRO, INT_ID_TO, SECT_ID, OLD_STREET, Street_Des) %>%
rename(asset.id = 'ASSETID',
fromint.id = 'INT_ID_FRO',
toint.id = 'INT_ID_TO',
sect.id = 'SECT_ID',
old.desig = 'OLD_STREET',
new.desig = 'Street_Des') %>%
mutate(sect.id = as.double(sect.id)) %>%
st_set_geometry(NULL)
# load libraries
library(sf)
library(dplyr)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/Tim/Documents/data/street-slope-la/Streets_Centerline/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
# trim bss centerline
bss <- bss %>%
dplyr::select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
>>>>>>> origin/master
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
geom = 'geometry') %>%
mutate(sect.id = as.double(sect.id))
# trim boe centerline
boe <- boe %>%
<<<<<<< HEAD
select(ASSETID, INT_ID_FRO, INT_ID_TO, SECT_ID, OLD_STREET, Street_Des) %>%
=======
dplyr::select(ASSETID, INT_ID_FRO, INT_ID_TO, SECT_ID, OLD_STREET, Street_Des) %>%
>>>>>>> origin/master
rename(asset.id = 'ASSETID',
fromint.id = 'INT_ID_FRO',
toint.id = 'INT_ID_TO',
sect.id = 'SECT_ID',
old.desig = 'OLD_STREET',
new.desig = 'Street_Des') %>%
mutate(sect.id = as.double(sect.id)) %>%
st_set_geometry(NULL)
<<<<<<< HEAD
# left-join bss <- boe
#streets <- bss %>%
#  left_join(boe, by="sect.id")
glimpse(boe)
glimpse(bss)
# left join bss <- boe
streets <- bss %>%
left_join(boe, by='sect.id')
# left join bss <- boe
streets <- bss %>%
inner_join(boe, by='sect.id')
map <- leaflet() %>%
addProviderTiles(providers$Stamen.TonerLite) %>%
addPolylines(
color = '#0E016F',
weight = 3,
opacity = 1,
data = streets
)
map
map <- leaflet() %>%
addProviderTiles(providers$Stamen.TonerLite) %>%
addPolylines(
color = '#0E016F',
weight = 3,
opacity = 1,
data = streets
)
map <- leaflet() %>%
addProviderTiles(providers$Stamen.TonerLite) %>%
addPolylines(
color = '#0E016F',
weight = 3,
opacity = 1,
data = streets
)
map
map <- leaflet() %>%
addProviderTiles(providers$Stamen.TonerLite) %>%
addPolylines(
color = '#0E016F',
weight = 1,
opacity = 1,
data = streets
)
map
rm(list=ls())
install.packages('raster')
library(raster)
# import elevation data
la_n <- raster("C:/Users/dotcid034/Documents/NonGitHubData/n35w119/grdn35w119_13")
la_s <- raster("C:/Users/dotcid034/Documents/NonGitHubData/n34w119/grdn34w119_13")
plot(la_n)
plot(la_s)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/dotcid034/Documents/NonGitHubData/boe/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
# import elevation data
la_n <- st_read("C:/Users/dotcid034/Documents/NonGitHubData/n35w119/ned_13arcsec_g.shp")
la_s <- st_read("C:/Users/dotcid034/Documents/NonGitHubData/n34w119/ned_13arcsec_g.shp")
glimpse(int)
=======
# left join bss <- boe
streets <- bss %>%
inner_join(boe, by='sect.id')
>>>>>>> origin/master
int <- int %>%
select(ASSETID, CL_NODE_ID, X, Y, LAT, LON, geometry) %>%
rename(asset.id = 'ASSETID',
clnode.id = 'CL_NODE_ID',
x = 'X',
y = 'Y',
lat = 'LAT',
lon = 'LON',
geom = 'geometry')
<<<<<<< HEAD
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/dotcid034/Documents/NonGitHubData/boe/Streets_Centerline.shp", quiet=TRUE)
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/dotcid034/Documents/NonGitHubData/boe/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
# trim bss centerline
bss <- bss %>%
select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
=======
library(raster)
# import elevation data & merge into one raster layer
la_n <- raster("C:/Users/Tim/Documents/data/street-slope-la/n35w119/grdn35w119_13")
la_s <- raster("C:/Users/Tim/Documents/data/street-slope-la/n34w119/grdn34w119_13")
la_elev <- merge(la_n, la_s)
# preview the merged raster
plot(la_elev)
# cast as sp object, extract elevation, convert back to sf object
int_sp <- as(int, "Spatial")
# cast as sp object, extract elevation, convert back to sf object
int_sp <- as_Spatial(int)
# cast as sp object, extract elevation, convert back to sf object
int_sp <- as_Spatial(st_geometry(int))
int
str(int)
plot(int)
plot(st_geometry(int))
# load libraries
library(sf)
library(dplyr)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/Tim/Documents/data/street-slope-la/Streets_Centerline/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
as_Spatial(int)
as(int, "Spatial")
int <- int %>%
select(ASSETID, CL_NODE_ID, X, Y, LAT, LON) %>%
rename(asset.id = 'ASSETID',
clnode.id = 'CL_NODE_ID',
x = 'X',
y = 'Y',
lat = 'LAT',
lon = 'LON')
int <- int %>%
dplyr::select(ASSETID, CL_NODE_ID, X, Y, LAT, LON) %>%
rename(asset.id = 'ASSETID',
clnode.id = 'CL_NODE_ID',
x = 'X',
y = 'Y',
lat = 'LAT',
lon = 'LON')
# cast as sp object, extract elevation, convert back to sf object
int_sp <- as(int, "Spatial")
int_elev <- extract(la_elev,
int_sp,
method='simple',
df=TRUE)
#int <- st_as_sf(int_elev)
# extract elevation
glimpse(int_elev)
# cast as sp object, extract elevation, convert back to sf object
int_sp <- as(int, "Spatial")
int_elev <- extract(la_elev,
int_sp,
method='simple')
#int <- st_as_sf(int_elev)
# extract elevation
glimpse(int_elev)
# cast as sp object, extract elevation, convert back to sf object
int_sp <- as(int, "Spatial")
int_elev <- extract(la_elev,
int_sp,
method='simple')
int_elev <- cbind(int, int_elev)
glimpse(int_elev)
streets <- streets %>%
inner_join(int_elev, by=c("fromint.id" = "clnode.id")) %>%
rename(from.elev = "int_elev") %>%
inner_join(int_elev, by=c("toint.id" = "clnode.id")) %>%
rename(to.elev = "int_elev")
# cast as sp object, extract elevation, convert back to sf object
int_sp <- as(int, "Spatial")
int_elev <- extract(la_elev,
int_sp,
method='simple')
int_elev <- cbind(int, int_elev)
int_elev <- int_elev %>%
select(clnode.id, int_elev) %>%
st_set_geometry(NULL)
# cast as sp object, extract elevation, convert back to sf object
int_sp <- as(int, "Spatial")
int_elev <- extract(la_elev,
int_sp,
method='simple')
int_elev <- cbind(int, int_elev)
int_elev <- int_elev %>%
dplyr::select(clnode.id, int_elev) %>%
st_set_geometry(NULL)
streets <- streets %>%
inner_join(int_elev, by=c("fromint.id" = "clnode.id")) %>%
rename(from.elev = "int_elev") %>%
inner_join(int_elev, by=c("toint.id" = "clnode.id")) %>%
rename(to.elev = "int_elev")
# trim bss centerline
bss <- bss %>%
dplyr::select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
>>>>>>> origin/master
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
geom = 'geometry') %>%
mutate(sect.id = as.double(sect.id))
<<<<<<< HEAD
# trim bss centerline
bss <- bss %>%
select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
=======
# trim boe centerline
boe <- boe %>%
dplyr::select(ASSETID, INT_ID_FRO, INT_ID_TO, SECT_ID, OLD_STREET, Street_Des) %>%
rename(asset.id = 'ASSETID',
fromint.id = 'INT_ID_FRO',
toint.id = 'INT_ID_TO',
sect.id = 'SECT_ID',
old.desig = 'OLD_STREET',
new.desig = 'Street_Des') %>%
mutate(sect.id = as.double(sect.id)) %>%
st_set_geometry(NULL)
# left join bss <- boe
streets <- bss %>%
inner_join(boe, by='sect.id') %>%
mutate(length.m = 3.28084*length.ft)
streets <- streets %>%
inner_join(int_elev, by=c("fromint.id" = "clnode.id")) %>%
rename(from.elev = "int_elev") %>%
inner_join(int_elev, by=c("toint.id" = "clnode.id")) %>%
rename(to.elev = "int_elev") %>%
mutate(slope = (abs((from.elev - to.elev))/(length.m))*100)
# Set Color Palette
pal <- colorNumeric(
palette = "YlGnBu",
domain = streets$slope
)
# Create the leaflet map
map <- leaflet() %>%
addProviderTiles(providers$Stamen.TonerLite) %>%
addPolylines(
color = ~pal(slope),
weight = 1,
opacity = 1,
data = streets) %>%
addLegend(pal = pal,
values = streets$slope,
position = "bottomright",
title = "Slope",
labFormat = labelFormat(suffix = "%"))
map
# trim bss centerline
bss <- bss %>%
dplyr::select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
>>>>>>> origin/master
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
geom = 'geometry') %>%
mutate(sect.id = as.double(sect.id))
<<<<<<< HEAD
rm(list=ls())
# load libraries
library(sf)
library(tidyverse)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/dotcid034/Documents/NonGitHubData/boe/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
glimpse(boe)
glimpse(bss)
# trim bss centerline
bss <- bss %>%
select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
=======
# load libraries
library(sf)
library(dplyr)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/Tim/Documents/data/street-slope-la/Streets_Centerline/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
# trim bss centerline
bss <- bss %>%
dplyr::select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
>>>>>>> origin/master
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
geom = 'geometry') %>%
mutate(sect.id = as.double(sect.id))
<<<<<<< HEAD
=======
# trim boe centerline
boe <- boe %>%
dplyr::select(ASSETID, INT_ID_FRO, INT_ID_TO, SECT_ID, OLD_STREET, Street_Des) %>%
rename(asset.id = 'ASSETID',
fromint.id = 'INT_ID_FRO',
toint.id = 'INT_ID_TO',
sect.id = 'SECT_ID',
old.desig = 'OLD_STREET',
new.desig = 'Street_Des') %>%
mutate(sect.id = as.double(sect.id)) %>%
st_set_geometry(NULL)
# left join bss <- boe
streets <- bss %>%
inner_join(boe, by='sect.id') %>%
mutate(length.m = 3.28084*length.ft)
streets <- streets %>%
inner_join(int_elev, by=c("fromint.id" = "clnode.id")) %>%
rename(from.elev = "int_elev") %>%
inner_join(int_elev, by=c("toint.id" = "clnode.id")) %>%
rename(to.elev = "int_elev") %>%
mutate(slope = (abs((from.elev - to.elev))/(length.m))*100) %>%
filter(slope < 10)
# Set Color Palette
pal <- colorNumeric(
palette = "YlGnBu",
domain = streets$slope
)
# Create the leaflet map
map <- leaflet() %>%
addProviderTiles(providers$Stamen.TonerLite) %>%
addPolylines(
color = ~pal(slope),
weight = 1,
opacity = 1,
data = streets) %>%
addLegend(pal = pal,
values = streets$slope,
position = "bottomright",
title = "Slope",
labFormat = labelFormat(suffix = "%"))
map
# load libraries
library(sf)
library(dplyr)
library(leaflet)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/Tim/Documents/data/street-slope-la/Streets_Centerline/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
>>>>>>> origin/master
# trim bss centerline
bss <- bss %>%
dplyr::select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
geom = 'geometry') %>%
mutate(sect.id = as.double(sect.id))
# trim boe centerline
boe <- boe %>%
dplyr::select(ASSETID, INT_ID_FRO, INT_ID_TO, SECT_ID, OLD_STREET, Street_Des) %>%
rename(asset.id = 'ASSETID',
fromint.id = 'INT_ID_FRO',
toint.id = 'INT_ID_TO',
sect.id = 'SECT_ID',
old.desig = 'OLD_STREET',
new.desig = 'Street_Des') %>%
mutate(sect.id = as.double(sect.id)) %>%
st_set_geometry(NULL)
# left join bss <- boe
streets <- bss %>%
<<<<<<< HEAD
inner_join(boe, by='sect.id')
glimpse(streets)
glimpse(int)
int <- int %>%
dplyr::select(ASSETID, CL_NODE_ID, X, Y, LAT, LON, geometry) %>%
rename(asset.id = 'ASSETID',
clnode.id = 'CL_NODE_ID',
x = 'X',
y = 'Y',
lat = 'LAT',
lon = 'LON',
geom = 'geometry')
int <- int %>%
dplyr::select(ASSETID, CL_NODE_ID, X, Y, LAT, LON, geometry) %>%
rename(asset.id = 'ASSETID',
clnode.id = 'CL_NODE_ID',
x = 'X',
y = 'Y',
lat = 'LAT',
lon = 'LON',
geom = 'geometry')
library(raster)
# import elevation data
la_n <- raster("C:/Users/dotcid034/Documents/NonGitHubData/n35w119/grdn35w119_13")
la_s <- raster("C:/Users/dotcid034/Documents/NonGitHubData/n34w119/grdn34w119_13")
# merge the raster files
la <- merge(la_n, la_s)
plot(la)
values <- extract(la_raster, int)
library(raster)
# import elevation data
la_n <- raster("C:/Users/dotcid034/Documents/NonGitHubData/n35w119/grdn35w119_13")
la_s <- raster("C:/Users/dotcid034/Documents/NonGitHubData/n34w119/grdn34w119_13")
# merge the raster files
la_raster <- merge(la_n, la_s)
# view the resulting pot
plot(la_raster)
values <- extract(la_raster, int)
glimpse(int)
la@crs
=======
inner_join(boe, by='sect.id') %>%
mutate(length.m = 3.28084*length.ft)
la_streets <- streets %>%
inner_join(int_elev, by=c("fromint.id" = "clnode.id")) %>%
rename(from.elev = "int_elev") %>%
inner_join(int_elev, by=c("toint.id" = "clnode.id")) %>%
rename(to.elev = "int_elev") %>%
mutate(slope = (abs((from.elev - to.elev))/(length.m))*100) %>%
filter(slope > 5)
# Set Color Palette
pal <- colorNumeric(
palette = "YlGnBu",
domain = streets$slope
)
# Create the leaflet map
map <- leaflet() %>%
addProviderTiles(providers$Stamen.TonerLite) %>%
addPolylines(
color = ~pal(slope),
weight = 1,
opacity = 1,
data = streets) %>%
addLegend(pal = pal,
values = streets$slope,
position = "bottomright",
title = "Slope",
labFormat = labelFormat(suffix = "%"))
# Set Color Palette
pal <- colorNumeric(
palette = "YlGnBu",
domain = la_streets$slope
)
# Create the leaflet map
map <- leaflet() %>%
addProviderTiles(providers$Stamen.TonerLite) %>%
addPolylines(
color = ~pal(slope),
weight = 1,
opacity = 1,
data = la_streets) %>%
addLegend(pal = pal,
values = la_streets$slope,
position = "bottomright",
title = "Slope",
labFormat = labelFormat(suffix = "%"))
map
<<<<<<< HEAD
# load libraries
library(sf, quietly = TRUE, warn.conflicts = FALSE)
library(dplyr, quietly = TRUE, warn.conflicts = FALSE)
library(leaflet, quietly = TRUE, warn.conflicts = FALSE)
library(geosphere, quietly = TRUE, warn.conflicts = FALSE)
# import street data
bss <- st_read("Data/Street_Pavement_Condition.shp",quiet=TRUE)
boe <- st_read("C:/Users/Tim/Documents/data/street-slope-la/Streets_Centerline/Streets_Centerline.shp", quiet=TRUE)
int <- st_read("Data/Intersections.shp", quiet=TRUE)
glimpse(boe)
glimpse(bss)
# trim bss centerline
bss <- bss %>%
dplyr::select(SECT_ID, PRIME, FROM_, TO_, SURF1, ZLENGTH, ZWIDTH, geometry) %>%
rename(sect.id = 'SECT_ID',
street = 'PRIME',
from = 'FROM_',
to = 'TO_',
surface = 'SURF1',
length.ft = 'ZLENGTH',
width.ft = 'ZWIDTH',
geom = 'geometry') %>%
mutate(sect.id = as.character(sect.id)) %>%
st_set_geometry(NULL)
# trim boe centerline
boe <- boe %>%
dplyr::select(ASSETID,
INT_ID_FRO,
INT_ID_TO,
SECT_ID,
STNAME,
OLD_STREET,
Street_Des) %>%
rename(asset.id = 'ASSETID',
fromint.id = 'INT_ID_FRO',
toint.id = 'INT_ID_TO',
sect.id = 'SECT_ID',
street = 'STNAME',
old.desig = 'OLD_STREET',
new.desig = 'Street_Des') %>%
mutate(sect.id = as.character(sect.id))
glimpse(int)
int <- int %>%
dplyr::select(ASSETID, CL_NODE_ID, FROM_ST, TO_ST, X, Y, LAT, LON) %>%
rename(asset.id = 'ASSETID',
clnode.id = 'CL_NODE_ID',
from = 'FROM_ST',
to = 'TO_ST',
lat = 'LAT',
lon = 'LON')
library(raster, quietly = TRUE, warn.conflicts = FALSE)
# import elevation data & merge into one raster layer
la_n <- raster("C:/Users/Tim/Documents/data/street-slope-la/n35w119/grdn35w119_13")
la_s <- raster("C:/Users/Tim/Documents/data/street-slope-la/n34w119/grdn34w119_13")
la_elev <- merge(la_n, la_s)
# preview the merged raster
plot(la_elev)
# cast as sp object, extract elevation, convert back to sf object
int_sp <- as(int, "Spatial")
int_elev <- extract(la_elev,
int_sp,
method='simple')
int_elev <- cbind(int, int_elev)
int_elev <- int_elev %>%
dplyr::select(clnode.id,
lat,
lon,
int_elev) %>%
st_set_geometry(NULL)
glimpse(int_elev)
streets <- boe %>%
mutate(len = st_length(boe)) %>% # get length
inner_join(int_elev, by=c("fromint.id" = "clnode.id")) %>%
rename(from.elev = "int_elev") %>%
inner_join(int_elev, by=c("toint.id" = "clnode.id")) %>%
rename(to.elev = "int_elev",
from.lat = "lat.x",
from.lon = "lon.x",
to.lat = "lat.y",
to.lon = "lon.y") %>%
mutate(slope = (abs((from.elev - to.elev))/(as.numeric(len)))*100) %>% # Slope
filter(!sect.id %in% c('closed', 'private', 'none', NA, 'outside')) %>%
filter(!old.desig %in% c('Unknown Type or Closed Street',NA)) %>%
filter(as.numeric(len) > 50)
# semi join boe <- bss
streets <- streets %>%
left_join(bss, by='sect.id') %>% # join to bss
dplyr::select(-street.y, -from, -to, -surface, -length.ft) %>% # only keep width
rename(street = 'street.x') %>%
distinct(asset.id, .keep_all=TRUE) #unique assetIDs, but keep all cols
# Sort by slope
streets %>%
mutate(From = paste0("(", from.lat, ",", from.lon,")"),
To = paste0("(", to.lat, ",", to.lon, ")")) %>%
dplyr::select(street, slope, len, From, To) %>%
rename(Length = 'len',
Slope = 'slope') %>%
filter(as.numeric(Length) > 150) %>%
arrange(desc(Slope)) %>%
head() %>%
st_set_geometry(NULL)
# Set Color Palette
pal <- colorNumeric(
palette = "YlGnBu",
domain = streets$slope
)
# Create the map
plot(x = streets)
svg(filename="LAStreets_slope.svg",
width=15,
height=20,
pointsize=12)
plot(streets["slope"])
dev.off()
st_write(streets, "streets_slope.shp")
=======
>>>>>>> origin/master
>>>>>>> ab384e6cd3f017dce9e7d273fac41bf48f398611
